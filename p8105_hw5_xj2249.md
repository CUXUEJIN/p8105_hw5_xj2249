p8105\_hw5\_xj2249
================
xj2249
10/31/2019

# Problem1

``` r
iris_with_missing <-
        iris %>% 
        map_df(~replace(.x, sample(1:150, 20), NA)) %>%
        mutate(Species = as.character(Species))

# write a function
replace_missing <- function(vector) {
        
        if (is.numeric(vector)) {
                replace_na(vector,mean(vector,na.rm = TRUE))
        } else if (is.character(vector)) {
                replace_na(vector,"virginica")
        }
}
# apply my 'replace_missing' function
iris_without_missing <-
        iris_with_missing %>% 
        map(replace_missing) %>% 
        bind_cols() %>% 
        janitor::clean_names() 
```

# Problem2

``` r
study_df <- 
        tibble(file_names = list.files("./data"),
               path = str_c("./data/", file_names)) %>%
        mutate(data = map(path, read_csv)
        ) %>% 
        unnest() %>% 
        select(-path) %>% 
        pivot_longer(
                -file_names,
                names_to = "week",
                names_prefix = "week_",
                values_to = "observations"
                ) %>% 
        mutate(file_names = str_remove(file_names,".csv"),
               week = factor(week)) 
```

## spaghetti plot

``` r
study_df %>% 
        mutate(group = str_sub(file_names,1,3),
               group = factor(group)) %>% 
        ggplot(aes(x = week, y = observations, color = file_names)) +
        geom_point(size = 1) +
        geom_line(aes(group = file_names)) +
        facet_grid(.~ group,labeller = as_labeller(c("con" =  "control", "exp" = "experiment"))) +
        labs(title = "Observations on each subject over time") + 
        theme(legend.position = "bottom")
```

<img src="p8105_hw5_xj2249_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />

comment on differences between groups.
